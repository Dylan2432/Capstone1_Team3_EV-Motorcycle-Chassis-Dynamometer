# Brake Control System

## Functionality
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The Brake Control System is being implemented to allow for the ability to apply a user-controlled load. This system will be the driving factor behind ensuring the customer’s desires are satisfied. With this system the user shall be able to induce a controlled load on the drum’s shaft in order to derive a torque measurement as well as apply a braking resistance. This will be made possible with the implementation of a 3-phase induction motor connected to the drum shaft mechanically. In addition, a Variable Frequency Drive (VFD) will be connected to the motor with a braking resistor connected to the VFD. Through the coaction of these components, this subsystem will be able to deliver desired metrics over various simulated conditions.

## Constraints
|No.        |Constraints   |Origin   |
|---|---------------------|--------|
|3|The system shall be able to handle a roller induced torque of up to 19.13 lb-ft.         |Design Constraint |
|5|Comply with all relevant codes and standards listed in II. Ethical, Professional, and Standard Considerations focusing on NFPA 79 – 10.7.1. (emergency stops)       |Safety Constraint|
|20|The motor shall have a maximum torque rating of, at minimum, +20% of maximum expected torque reading.         |Derived from further considerations |
|21|The motor shall be able to handle a maximum expected roller rotational speed of 1288 rpm.       |Derived from further considerations|
|22|The VFD must be rated for a 460 volt, 1-phase input.       |Derived from further considerations|
|23|The VFD must be rated for a normal load current rating of 10.96 amps.      |Derived from further considerations|
|24|The braking resistor shall be capable of dissipating, at minimum, 3500 Watts.       |Derived from further considerations|

3.) The maximum calculated torque value that the applied motor shall experience from the roller is 19.13 lb-ft. The selected motor must be able to safely and effectively handle all events in which values up to this maximum are present. Therefore, the process of motor selection will include major attention to the breakdown torque capacity.<br><br>
5.) This system will follow all relevant codes and standards listed in the conceptual design and proposal. One standard with a high magnitude of importance that will be met throughout this design is NFPA 79 – 10.7.1. This standard encompasses that any electrically operated industrial device must possess an emergency stop. This will be implemented through the collaboration of both this system as well as mechanical design.<br><br>
20.) To ensure safety and the selected motor’s ability to handle to maximum expected torque value, the maximum applied torque with an extra 20% must be within the component’s torque range. This comes out to a maximum torque of 22.96 lb-ft. This value will be used within the torque evaluation to determine the most suitable motor.<br><br>
21.) To correctly operate and ensure component safety, the selected motor must be able to handle rotational speeds up to 1288 rpm. This rating will be a driving factor in the selection of the implemented motor. If the motor selected can’t handle a 1288 rotational speed, stator damage may occur.<br><br>
22.) To ensure the selected VFD can operate within the voltage supply available, it must be rated for 460 volt, 1-phase input. This is due to 3-phase power not being readily available at the build site.<br><br>
23.) The calculated output current capacity needed to use the VFD as a phase converter is 10.96 amps. Therefore, the selected VFD must be rated for these conditions.<br><br>
24.) In order to ensure the selected braking resistor is sized correctly, it shall be rated to handle the bike’s maximum power output (3500 W).<br><br>

## Schematics
### Full Brake Control System Diagram
![image](https://github.com/user-attachments/assets/b051b0d7-31c7-4526-9a40-d29c96fce3e3)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Presented above is the full system diagram of how components will be connected to create a correctly functioning regenerative braking system. The VFD will be fed a 1-phase, 460 V input through 2 if its input terminals (R and S). Through phase conversion, this will then be outputted to the 3-phase motor from its output terminals (U, V, and W). The drive’s ports for integrating a brake resistor (B1 and B2) will also be used to allow for power dissipation. Additionally, to control the drive’s operating functions, the analog input port will be fed signals from the DAQ. The operation and purpose of each of these components will be further explained in the analysis section as well as the support subsystems.
### Dayton 3-Phase 5 HP Motor Ratings
![image](https://github.com/user-attachments/assets/76eb5aa8-5c99-4486-b1d9-3dcdd0806474)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Presented above are the motor ratings of this selected 3-phase 5 Horsepower motor. These specifications meet all motor requirements needed to ensure correct and safe operation. The reasoning for this motor selection will be further explained in the analysis section.

### E-Stop Wire Diagram
![image](https://github.com/user-attachments/assets/219843c4-a0bf-44cc-8683-ee9f8dfb968c)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Presented above is the wire diagram portraying how an emergency stop push button will be wired to the VFD. The purpose and application of this will be further explained in the analysis section.

## Analysis
### Motor Selection Analysis
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Dayton 5-HP 3-phase motor was the decided upon component to be used to drive the ability to create a controlled braking system. This component was selected through a series of well thought out steps and calculations.<br><br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The first motor parameter that was looked at in this selection process was the motor duty rating. Due to using a VFD, an inverter duty motor rating was decided to be a requirement. This is due to these motors being able to run at much lower speeds without overheating and being capable of withstanding higher voltage spikes than non-inverter rated motors. Since this dyno will be testing the bike at various speeds and the max rotational speed that the motor will be driven at is lower than its rated speed, this is a crucial capability to ensure efficient and safe operation. <br><br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;After selecting the type of motor, the next characteristics that were looked at was the torque and rpm ratings needed to provide correct operation. Before these metrics could be calculated, a roller size had to be set. This metric was decided to be 12 inches in diameter based on safety calculations and considerations made by the mechanical team. With this parameter, the maximum rpm that the motor must be able to test can be found. This is derived using the equation $RPM = \frac{(Speedmax(\frac{m}{s}))(60)}{(π)(Diameter(m))}$.
This equation was pulled from the website emotorsdirect listed below in the references section. The maximum speed of the bike (74 km/h or 20.56 m/s) and the 12-inch diameter of the roller are the metrics used to compute the rpm value with the given equation. After plugging these values in, the maximum rotational speed of the roller comes out to 1288 rpm. This value sets a maximum rotational speed that the motor selected most be able to read. Moreover, the maximum torque of the roller is derived using the equation $Power = (torque)(2π)(RPM)$. This is the base equation pulled from the website powertestdyno, also listed in the references section, to derive the equation needed to find the maximum torque value. To get this equation, the relation between horsepower and torque (lb-ft) is used: $1 HP = 33,000(\frac{(lb-ft)}{min})$. Plugging this relation in gives the equation $33,000(\frac{(lb-ft)}{min}) = torque(lb-ft)(2π)(RPM)$. To then simplify this equation, each side can be divided by 2π to compute the equation $5252(\frac{(lb-ft)}{min}) = torque(lb-ft)(RPM)$. Then, by dividing each side by 5,252 the final needed equation comes out to $HP = \frac{(torque(lb-ft))(RPM)}{5252}$. This can then be rewritten as $torque(lb-ft) = \frac{(HP)(5252)}{RPM}$.  To find the maximum torque value with this equation, the max power rating of the bike (3500 W) is converted to horsepower with the relation 1HP = 746 W. This gives a horsepower value of 4.69. The then previously calculated 1288 rpm metric is plugged in to find that the max torque of the roller is 19.13 lb-ft (25.94 Nm). However, for safety and operation assurance, 20% is added to this value. This brings the max breakdown torque that the motor must handle up to 22.96 lb-ft. With these two values, the parameters at which the motor must operate were set.<br><br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When comparing the required ratings with the selected motor’s datasheet, it can be seen that all requirements are met with considerable safety factors. For, the rated rotational speed and breakdown torque ratings of the motor are respectively 1760 rpm and 46.19 lb-ft. With these 2 ratings, the requirements in both constraints 3 and 21 are met. Furthermore, with a breakdown torque rating of 46.19 lb-ft, constraint 20’s requirements are also met as this results in a safety factor of 100%. <br><br>
### VFD Analysis
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;With the selection of the motor, the application of regenerative braking, with a VFD, becomes possible and suitable for testing desired parameters. This process is achieved by connected the variable frequency drive to the motor to apply a braking affect. This braking affect is produced by using the VFD to lower the frequency applied to the motor. However, simply lowering the frequency value does not result in the motor beginning to act as a brake. This is due to the synchronous speed rating of the motor. This rating is the speed at which, if exceeded, a motor will become a generator when driven by its shaft. This value is derived through the equation $N_s = \frac{(120)(frequency)}{Number Poles}$. The frequency and number of poles of the selected motor are, respectively, 60hz and 4 poles. With these values a synchronous speed of 1800rpm is found. The drum’s max rotational speed is 1288; therefore, this value must be stepped down to apply a braking effect to the system even at maximum speed. From the equation previously presented, it can be seen that the frequency directly affects the synchronous speed rating. Therefore, by using the VFD’s frequency control features, the required synchronous speed needed to switch motor operation to a generator can be controllably decreased or increased. This switch in operation is required in order to induce the desired braking effect. For, once the motor becomes a generator, the current will invert direction and backflow into the VFD. This will develop a counter torque and cause the motor to operate as a brake.<br><br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In order to select and size the chosen VFD, different parameters were taken into account. The first, and main, factor that contributed to the selection of this unit included it being used also as a phase converter. Due to inputting single phase power into the VFD, it can not be simply sized based on its horsepower rating. Instead, it must be derated and selected based on its max output current rating. This stems from the conversion from 1 phase to 3 phase current being the (amperage*√3). Therefore, the need amperage rating is found by multiplying the motor’s full load amperage by the square root of 3. This calculation results in a current rating of 10.96 amps. This output current rating, for our implementation, must be less than or equal to the normal load current rating of the VFD. This is due to our system experiencing variable torque. Additionally, this rating must also be for a 1 phase (60Hz), 460 V input drive. Through the validation of these parameters, the Ironhorse ACG-4010 VFD was proven to be the best component for our system. For, its output current rating, with a 460 V, 1-Phase (60Hz) input, at normal load is 12.6 amps. With the selection of this VFD, the requirements for both constraints 22 and 23 are met.<br><br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In addition, automation direct requires and suggests a line reactor to be used when using a VFD as a phase converter. However, we will be using a transformer to step up our 120 volt supply to 460 before feeding it to the VFD. This transformer will act as the line reactor required for this set up.<br><br>

### Braking Resistor Analysis
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Due to this system operating on regenerative braking, current backflow will be present into the VFD. Therefore, operation must be put into place in order to dissipate the generated power. This will be done by connected a braking resistor to the DC Bus terminals of the VFD in order to dissipate this generated energy through heat. This is required when using a VFD, with a motor acting as a generator, due to the power back feed. This reverse flow into the VFD, if not properly dissipated, will cause the drive’s DC bus voltage to rise, resulting in over-voltage faults. This will lead to the drive protecting itself by shutting down, or possibly lead to damage to the input rectifiers. <br><br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In order to select and size the chosen braking resistor, 2 main factors were taken into account. The first parameter is the minimum resistance value. This value won’t affect the resistor’s ability to dissipate the incoming power; however, it is vital to making sure it is compatible with the chosen VFD. This compatibility lies within the VFD’s internal brake chopper circuitry. This circuitry consists of a brake transistor that shunts excess current from the DC bus to the braking resistor. However, this transistor exhibits a maximum current rating listed within the datasheet. With this current rating and the over-voltage level of the VFD, the minimum rating of the resistor can be found through ohm’s law. The over-voltage level for the selected resistor is 820VDC. This value is 130%-150%  of the drive’s nominal dc bus voltage threshold. Therefore, the nominal dc bus voltage level is between 550 VDC and 630VDC. This puts the minimum resistance value of the resistor at 34.6Ω. The second parameter is the power dissipation capacity. This rating will ensure that the resistor is capable of handling the power sent to it from the VFD. For this rating, the maximum power of the bike is used (3500 W). With these required parameters, the Ironhorse GS-BR-1K5W043 braking resistor was selected. This resistor’s ratings for resistance and peak power are, respectively, 49 Ω and 12.4 kW. This component not only meets the required ratings, but also is the recommended component to use with the previously selected VFD. With these ratings, this component also meets the requirements of constraint 24.<br><br>

### E-Stop Analysis
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Customer request and standard NFPA 79 – 10.7.1. require that an emergency stop be present in the event of dangerous situations. This requirement will be met through the process of implementing a emergency stop bush button wired to the stop terminal of the VFD's control circuitry. This wire setup is presented in the above schematics section. This system is powered by a 24 VDC source generated by the VFD's internal AC to DC converters. The P3 coil (stop coil) shuts off the VFD in the event that its power source is taken away. Therefore, once the button is pushed (opening the circuit) this coil will shut the VFD off. This will allow for an imediate stop to the VFD in order to protect it against whatever dangerous situation is occuring. This capability also allows the requirements of constraint 5 to be met.<br><br>

## BOM
|Item        |Quantity   |Price   |Total   |
|------------|-----------|--------|--------|
|Dayton 3-Phase 5 HP Motor|1          |$888.03 |$888.03|
|Ironhorse ACG-4010 VFD|1          |$348.00 |$348.00|
|Ironhorse GS-BR-1K5W043 Braking Resistor|1          |$144.00 |$144.00|
|Automation Direct E-Stop Push Button|1                 |$16.50| $16.50|
|Subsystem Total |||$1396.53|

## References
VFD & Braking Resistor Data Sheet: https://cdn.automationdirect.com/static/specs/acgdrives.pdf<br>
Dayton 3-Phase 5 HP Motor Datasheet: https://www.grainger.com/ec/pdf/36VF38_4.pdf<br>
Automation Direct E-Stop PB (Illuminated) (N.C contact) Datasheet: https://cdn.automationdirect.com/static/specs/cents22mmmush.pdf
